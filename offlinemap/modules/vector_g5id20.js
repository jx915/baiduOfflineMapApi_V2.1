_jsload2&&_jsload2('vector', 'x.extend(Pc.prototype,{ra:function(a,b){Hc.prototype.ra.call(this,a,b);this.Bg={};this.br(a);this.oq();this.Kq()},remove:function(){var a=this.C;Hc.prototype.remove.call(this);a&&(a.removeEventListener("zoomend",this.Xk),a.removeEventListener("moveend",this.Bk),a.removeEventListener("resize",this.Ik),a.removeEventListener("hotspotclick",this.PL),a.am(this.k.Ak))},br:function(a){this.C=a;this.HB=this.Qb;this.yc=this.C.K.devicePixelRatio;this.jn=62;a.am(this.k.Ak);for(var b in this.hp)delete this.hp[b]}, oq:function(){var a=this,b=this.C;a.Xk=function(b){a.Kq(b)};a.Bk=function(b){a.Kq(b)};a.Ik=function(b){a.Kq(b)};a.PL=function(b){0<b.spots.length&&a.QT(b.spots[0].getUserData().uid)};b.addEventListener("zoomend",a.Xk);b.addEventListener("moveend",a.Bk);b.addEventListener("resize",a.Ik);b.addEventListener("hotspotclick",a.PL)},QT:function(a){var b=this,c=(1E5*Math.random()).toFixed(0);!z._rd&&(z._rd={});z._rd["_cbk"+c]=function(a){b.$Q(a);delete z._rd["_cbk"+c]};var d=b.aW;this.k.dh&&(d=b.bW);a=d+ a+"?scope=2&ak="+this.k.Sl+"&callback=BMap._rd._cbk"+c;this.k.dh&&(a+="&geotable_id="+this.k.dh);pa(a)},$Q:function(a){var b=a.content;this.k.dh&&(b=a.contents[0]);if(a&&0==a.status&&b){var a={poiId:b.uid||"",databoxId:b.databox_id||"",title:this.k.dh?b.title:b.name,address:this.k.dh?b.address:b.addr,phoneNumber:b.tel||"",postcode:b.zip||"",provinceCode:1*b.province_id||-1,province:b.province||"",cityCode:1*b.city_id||-1,city:b.city||"",districtCode:1*b.district_id||-1,district:b.district||"",point:this.k.dh? new H(b.location[0],b.location[1]):new H(b.longitude,b.latitude),tags:b.tag&&b.tag.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,"").split(/\\s+/),typeId:1*b.cla||-1,extendedData:b.ext||{}},c=new O("onhotspotclick");c.customPoi=a;c.content=b;this.GF&&this.GF.dispatchEvent(c);this.dispatchEvent(c)}},Kq:function(){var a=this.C,b=a.fa(),c=a.cb.wm(this.HB,"yun",this.jn);if(a.Vb()){this.Gm||(this.Gm=o,0<c.length&&(this.Pb=a.pa().k.Pb));this.Ym=Math.pow(2,18-b);this.qh=c.length;a=0;for(b=c.length;a<b;a++)this.rr(c[a][0], c[a][1],c[a][2])}},rr:function(a,b,c){var d=this,e=d.map,f=e.Ka(),g=new H(f.lng,f.lat),i=e.fa(),e=Sc[Math.abs(a+b)%Sc.length]+"/data?grids="+a+"_"+b+"_"+i+"&q="+this.k.Vm+"&tags="+this.k.gu+"&filter="+this.k.filter+"&sortby="+this.k.Gy+"&ak="+this.k.Sl+"&age="+this.k.tw,e=this.k.dh?e+("&geotable_id="+this.k.dh):e+("&databox_id="+this.k.xK);c.Ze=q;pa(e,function(e){var e=0==e.status?e.content[0].data:[],f=d.map,m=f.Ka(),f=f.fa();m.nb(g)&&f==i&&(d.On(e,c,a,b,i),d.qh--,0==d.qh&&d.GF.dispatchEvent("oncustomlayerloaded"))})}, On:function(a,b,c,d,e){var f=b.getContext("2d");1<this.yc&&!b.lg&&(f.scale(this.yc,this.yc),b.lg=o);b.GB||(b.GB=o,f.translate(this.jn/2,this.jn/2));for(var e="hotSpotTile_"+c+"_"+d+"_"+e,g=0,i=a.length;g<i;g++)this.qW(f,a[g],c,d,e,b)},qW:function(a,b,c,d,e,f){var g=this,i=b[0],k=b[1],l=b[2],m=b[3],g=this,n=this.Pb,b=this.Ym,c=c*b*n,d=(d+1)*b*n;/^POINT\\((.*)\\)$/.test(l);var l=RegExp.$1.split(","),t=l[0],v=l[1],w=(t-c)/b,y=(d-v)/b,C=new Image;C.onload=function(){var b=this.width,c=this.height;a.drawImage(this, w-b/2,y-c);g.hp[e]||(b={userData:{name:i,uid:k},offsets:[c,b/2,0,b/2]},b=new hb(R.Ab(new H(t,v)),b),g.C.ow(b,g.k.Ak));setTimeout(function(){g.hp[e]=o;f.Ze=o},1E3);delete this.onload};this.FX(m,function(a){""==m&&(m="sid1");C.src=a&&a.content&&a.content[m]&&""!=a.content[m]?"data:image/png;base64,"+a.content[m]:E.qa+"madian.png"})},W3:function(){if(this.Qb){for(var a=this.Qb,b=0,c=a.childNodes.length;b<c;b++)a.childNodes[b].Ze=q;this.C.am(this.k.Ak);for(var d in this.hp)delete this.hp[d];this.Kq()}}, FX:function(a,b){var c=this,d=this.k.xK,e=this.k.q_,f=this.k.Sl;""==a&&(a="sid1");if(this.Bg[a]&&this.Bg[a].data)b(this.Bg[a].data);else{this.Bg[a]||(this.Bg[a]={},this.Bg[a].ZB=[]);this.Bg[a].ZB.push(b);var g=z.Ac+"style/poi/rangestyle?method=getstyle";this.k.dh&&(d=this.k.dh);g+="&databox="+d+"&sid="+a+"&ak="+f;e&&(g+="&self_id="+e);this.Bg[a].oY||(setTimeout(function(){pa(g,function(b){var d=c.Bg[a].ZB;c.Bg[a].data=b;for(var e=0;e<d.length;e++)d[e](b);c.Bg[a].ZB.length=0})},10),c.Bg[a].oY=o)}}});x.extend(Qc.prototype,{ra:function(a,b){Hc.prototype.ra.call(this,a,b);this.br(a);this.oq();this.Zu()},remove:function(){var a=this.C;Hc.prototype.remove.call(this);a.removeEventListener("zoomend",this.Xk);a.removeEventListener("moveend",this.Bk);a.removeEventListener("resize",this.Ik)},br:function(a){this.C=a;this.HB=this.Qb;this.yc=this.C.K.devicePixelRatio;this.jn=0},oq:function(){var a=this,b=this.C;a.Xk=function(b){a.Zu(b)};a.Bk=function(b){a.Zu(b)};a.Ik=function(b){a.Zu(b)};b.addEventListener("zoomend", a.Xk);b.addEventListener("moveend",a.Bk);b.addEventListener("resize",a.Ik)},Zu:function(){var a=this.C,b=a.cb.wm(this.HB,"traffic",this.jn);this.Gm||(this.Gm=o,0<b.length&&(this.Pb=a.pa().k.Pb));for(var a=0,c=b.length;a<c;a++)this.rr(b[a][0],b[a][1],b[a][2])},rr:function(a,b,c){var d=this,e=d.map,f=e.Ka(),g=new H(f.lng,f.lat),i=e.fa(),k="_t"+parseInt(a+""+b+""+i).toString(36),e=this.N_+"&x="+a+"&y="+b+"&z="+i+"&fn=BMap."+k+"&t="+(new Date).getTime();c.Ze=q;z[k]=function(e){var f=d.map,n=f.Ka(),f= f.fa();n.nb(g)&&f==i&&e.content&&e.content.tf&&d.On(e.content.tf,c,a,b);delete z[k]};pa(e,q)},On:function(a,b){var c=b.getContext("2d"),d=this.re,e=this.lx,f=this.mx;1<this.yc&&!b.lg&&(c.scale(this.yc,this.yc),b.lg=o);b.GB||(b.GB=o,c.translate(this.jn/2,this.jn/2));for(var g=0,i=a.length;g<i;g++){var k=a[g],l=k[1],m=this.Fb[k[3]],k=this.Fb[k[4]],n=l[0]/10,t=l[1]/10;c.beginPath();c.moveTo(n,t);for(var v=2,w=l.length;v<w;v+=2)n+=l[v]/10,t+=l[v+1]/10,c.lineTo(n,t);c.strokeStyle=d(m[1]);c.lineWidth=m[2]; c.lineCap=e(m[3]);c.lineJoin=f(m[4]);c.stroke();c.strokeStyle=d(k[1]);c.lineWidth=k[2];c.lineCap=e(k[3]);c.lineJoin=f(k[4]);c.stroke()}b.Ze=o},re:function(a){a>>>=0;return"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},lx:function(a){return["butt","square","round"][a]},mx:function(a){return["miter","bevel","round"][a]}});x.extend(cb.prototype,{Ae:function(){this.ra(this.C,this.B)},ra:function(a,b){this.C=a;this.B=b;this.C&&this.B&&(this.br(),this.CS(),this.oq(),this.Jq())},remove:function(){var a=this.C;this.B.removeChild(this.Xa);a.removeEventListener("zoomend",this.Xk);a.removeEventListener("moving",this.TM);a.removeEventListener("moveend",this.Bk);a.removeEventListener("resize",this.Ik)},br:function(){var a=this.C,b=a.K.devicePixelRatio,c=a.pa().k.Pb,d=a.Bb(),a=d.width,d=d.height;this.Yh={};this.Pb=c;this.yc=b; this.DE=a;this.CE=d;this.sC=a*b;this.rC=d*b},CS:function(){var a=this.C,b=this.B,c=document.createElement("canvas"),d=c.style;d.position="absolute";d.zIndex=5;d.left=-a.offsetX+"px";d.top=-a.offsetY+"px";d.width=this.DE+"px";d.height=this.CE+"px";c.setAttribute("width",this.sC);c.setAttribute("height",this.rC);b.appendChild(c);this.Xa=c;this.Ih=c.getContext("2d");a=this.yc;1<a&&!c.lg&&(this.Ih.scale(a,a),c.lg=o)},oq:function(){function a(){b.Xa.style.left=-c.offsetX+"px";b.Xa.style.top=-c.offsetY+ "px"}var b=this,c=b.C,d=b.yc;b.Xk=function(c){b.Xa.style.display=18>this.fa()?"none":"block";a();b.Jq(c)};b.TM=function(c){var d=(new Date).getTime();100>d-b.oM||(b.oM=d,a(),b.Jq(c))};b.Bk=function(c){a();b.Jq(c)};b.Ik=function(e){var f=c.Bb(),g=f.width,f=f.height,i=g*d,k=f*d;b.Xa.style.width=g+"px";b.Xa.style.height=f+"px";b.Xa.setAttribute("width",i);b.Xa.setAttribute("height",k);b.DE=g;b.CE=f;b.sC=i;b.rC=k;a();b.Jq(e)};c.addEventListener("zoomend",b.Xk);c.addEventListener("moving",b.TM);c.addEventListener("moveend", b.Bk);c.addEventListener("resize",b.Ik)},Jq:function(a){var b=this.C,c=b.fa();if(!(18>c)){var d=b.cb.mL(),e=d[0],b=d[1],f=d[2],d=d[3],a=a?q:o,g;for(g in this.Yh)for(var i=e;i<f;i++)for(var k=b;k<d;k++)g==i+"_"+k+"_"+c&&(this.Yh[g].UH=o);for(g in this.Yh)this.Yh[g].UH?delete this.Yh[g].UH:(this.Yh[g]=p,delete this.Yh[g]);this.Ih.clearRect(0,0,this.sC,this.rC);for(i=e;i<f;i++)for(k=b;k<d;k++)(g=this.Yh[i+"_"+k+"_"+c])?this.On(g,i,k,c,a):this.rr(i,k,c,a)}},rr:function(a,b,c,d){var e=this,f=e.C,g=e.mV, i=(a+b)%g.length,k="x="+a+"&y="+b+"&z="+c,l=f.ba.replace(/^TANGRAM_/,"")+"building"+parseInt(a+""+b+""+c).toString(36),g=g[i]+"qt=hjpgvd&"+k+"&styles=pl&layers=bg&features=bd&f=mwebapp&v=001&udt=20130501&fn=BMap."+l,i=f.Ka(),m=new H(i.lng,i.lat),n=f.fa();z[l]=function(g){if(g=g.content){var i=f.Ka(),k=f.fa();if(!i.nb(m)||k!=n){delete z[l];return}if(g=window.$Y(g))e.On(g,a,b,c,d),e.Yh[a+"_"+b+"_"+c]=g}delete z[l]};pa(g)},On:function(a,b,c,d,e){e&&this.k.ZK?this.gR(a,b,c,d):this.iH(a,b,c,d,1)},gR:function(a, b,c,d){var e=this;a.TP=new rb({Gc:50,duration:200,va:function(f){e.iH(a,b,c,d,f)},finish:function(){a.TP=p}})},iH:function(a,b,c,d,e){var f=this.C,g=this.DE,i=this.CE,d=f.pa().Bc(d),f=f.mc,k=this.Pb,b=b*k-f.lng/d,c=(-1-c)*k+f.lat/d,d=this.Ih,f=a.length,k=0,l=window.Fb;d.save();for(d.translate(b+g/2,c+i/2);k<f;k++){var m=a[k],n=l[m[3]];if(4==n[0]){var t=m[7];window.VectorDrawUtils.WC(d,m[1],6*(m[2]*n[3])*e,90*((b+(t[0]+t[2])/2)/(g/2)),90*((c+(t[1]+t[3])/2)/(i/2)),"rgba(212,205,197,1)","rgba(235,233,228,1)", "rgba(170,170,170,1)",1)}}d.restore()}}); ');
